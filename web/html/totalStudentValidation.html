<div class="row no-margin no-padding">
  <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 no-padding DivCen">
    <label>Trade Name<i class="red"> *</i></label>
    <select id="trade" name="trade" class="form-control" required></select>
  </div>
  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 no-padding DivCen">
    <div class="row no-margin no-padding">
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 askForExperience DivCen">
        <label>Have Experience<i class="red"> *</i>
      </label>
        <div class="radioSex" style="text-align: center;">
          <input type="radio" name="experience" value="Yes" />Yes
          <input type="radio" name="experience" value="No" checked="checked" />No
        </div>
      </div>
      <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6 showExperienceDiv hide DivCen">
        <label>Experience in Year<i class="red"> *</i>
      </label>
        <select id="studentExpYear" name="studentExpYear" form="studentForm" class="form-control"></select>
      </div>
    </div>
  </div>
  <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 no-padding registration DivCen" id="myFunctionSubmitDiv">
    <button type="submit" value="Submit" onclick="myFunctionSubmit()">Submit</button>
  </div>
</div>
<script>
  var login = sessiongetItem("login");
  $('input:radio[name="experience"]').change(function() {
    if ($(this).val() == 'Yes') {
      $('.showExperienceDiv').removeClass('hide');

    } else {
      $('.showExperienceDiv').addClass('hide');
    }
  });

  function myFunctionSubmit() {
    $(".tablecontainerDiv").html(" ");
    $('.bodyloading').removeClass('hide');
    $('#containerDiv').addClass('hide');
    var trd = $('#trade').val();
    var exp1 = $('input[name=experience]:checked').val();
    if (exp1 === 'Yes') {
      status = "Experience";
      var exp2 = $('#studentExpYear').val();
    } else {
      status = "Fresher";
      exp2 = "NA";
    }
    var obj = {
      "Role": login.Role,
      "Name": login.Name,
      "Trade": trd,
      "Experience": status,
      "ExpYear": exp2
    };
    console.log(obj);
    getTableDiv();
    $.when(Posthandler("/route/studentTradeWiseFilter", obj, true)).done(function(res) {
      if (res.resCode == 'OK') {
        console.log(res);
        var arr = res.results;
        if (login.Role != "Company") {
          console.log(">>>>>>>>", login.Role != "Company", "  ", login.Role);
          $.each(arr, function(i, arr) {
            var body = "<tr>";
            body += "<td>" + arr["Name"] + "</td>";
            body += "<td>" + arr["Mobile"] + "</td>";
            body += "<td>" + arr["Email"] + "</td>";
            body += "<td>" + arr["Address"] + "</td>";
            body += "<td>" + arr["City"] + "</td>";
            body += "<td>" + arr["Pincode"] + "</td>";
            body += "<td>" + arr["College"] + "</td>";
            body += "<td class='editrow' data-toggle='modal' data-target='#exampleModalLong' title='Click Here for " + arr["Name"] + " More Details '><i class='fa fa-info-circle'  aria-hidden='true'></i> Info </td>";
            body += "</tr>";
            $("#totalStudentTable tbody").append(body);
          });
          create_DatatableTOtalStudent('#totalStudentTable');
          $('.dataTables_scrollHeadInner, .aboutMEeTable_header').css("width", "100%");
          viewMoreFunctionForStudent(arr);
        } else {
          $.each(arr, function(i, arr) {
            var body = "<tr>";
            body += "<td></td>";
            body += "<td>" + arr["Name"] + "</td>";
            body += "<td>" + arr["Mobile"] + "</td>";
            body += "<td>" + arr["Email"] + "</td>";
            body += "<td>" + arr["Address"] + "</td>";
            body += "<td>" + arr["City"] + "</td>";
            body += "<td>" + arr["Pincode"] + "</td>";
            body += "<td>" + arr["College"] + "</td>";
            body += "<td class='editrow' data-toggle='modal' data-target='#exampleModalLong' title='Click Here for " + arr["Name"] + " More Details '><i class='fa fa-info-circle'  aria-hidden='true'></i> Info </td>";
            body += "</tr>";
            $("#totalStudentTable1 tbody").append(body);
          });
          dataTableSet();
          viewMoreFunctionForStudent1(arr);
        }
        $('.bodyloading').addClass('hide');
        $('#containerDiv').removeClass('hide');
        $('.tablecontainerDiv').removeClass('hide');

      } else {
        console.log(res.results);
        swal("Error!", res.msg, "error");
        $('.bodyloading').addClass('hide');
        $('#containerDiv').removeClass('hide');
      }
    }).fail(function() {
      swal("Error!", "sorry unable to check Trade list. please check your internet connection", "error");
    });
  };

  function dataTableSet() {
    // create_DatatableTOtalStudentFilter('#totalStudentTable');
    var table = $('#totalStudentTable1').DataTable({
      'columnDefs': [{
        'targets': 0,
        'searchable': false,
        'orderable': false,
        'className': 'dt-body-center',
        'render': function(data, type, full, meta) {
          return '<input type="checkbox" name="id[]" value="' + $('<div/>').text(data).html() + '">';
        }
      }],
      'order': [
        [1, 'asc']
      ]
    });

    // Handle click on "Select all" control
    $('#example-select-all').on('click', function() {
      // Get all rows with search applied
      var rows = table.rows({
        'search': 'applied'
      }).nodes();
      // Check/uncheck checkboxes for all rows in the table
      $('input[type="checkbox"]', rows).prop('checked', this.checked);
    });

    // Handle click on checkbox to set state of "Select all" control
    $('#totalStudentTable1 tbody').on('change', 'input[type="checkbox"]', function() {
      // If checkbox is not checked
      if (!this.checked) {
        var el = $('#example-select-all').get(0);
        // If "Select all" control is checked and has 'indeterminate' property
        if (el && el.checked && ('indeterminate' in el)) {
          // Set visual state of "Select all" control
          // as 'indeterminate'
          el.indeterminate = true;
        }
      }
    });

    // Handle form submission event
    $('#frm-example').on('submit', function(e) {
      var form = this;

      // Iterate over all checkboxes in the table
      table.$('input[type="checkbox"]').each(function() {
        // If checkbox doesn't exist in DOM
        if (!$.contains(document, this)) {
          // If checkbox is checked
          if (this.checked) {
            // Create a hidden element
            $(form).append(
              $('<input>')
              .attr('type', 'hidden')
              .attr('name', this.name)
              .val(this.value)
            );
          }
        }
      });
    });
  }

  function getTableDiv() {
    if (login.Role != "Company") {
      // alert("login.Role != Company");
      $('.tablecontainerDiv').html(
        "<section class='content'><div class='boxC'><table id='totalStudentTable' class='cell-border display aboutMEeTable_header'  cellspacing=0 width=100%><thead class='leaveTable_header'><tr><th>Name</th><th>Contact No</th><th>Email</th><th>Address</th><th>City</th><th>Pincode</th><th>College</th><th>More Information</th></tr></thead><tbody class='aboutMeTable_body'></tbody></table></div></section>"
      );
    } else {
      // alert("login.Role == Company");
      $('.tablecontainerDiv').html(
        "<section class='content'><div class='boxC'><table id='totalStudentTable1' class='cell-border display aboutMEeTable_header'  cellspacing=0 width=100%><thead class='leaveTable_header'><tr><th><input name='select_all' value='1' id='example-select-all' type='checkbox'></th><th>Name</th><th>Contact No</th><th>Email</th><th>Address</th><th>City</th><th>Pincode</th><th>College</th><th>More Information</th></tr></thead><tbody class='aboutMeTable_body'></tbody></table></div></section>"
      );
    }
  }
</script>
